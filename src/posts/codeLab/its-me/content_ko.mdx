---
title: 'AI 기반 인터랙티브 포트폴리오 챗봇 (its-me)'
desc: 'RAG 기반의 대화형 포트폴리오 챗봇 개발 과정과 기술적 구현 방법을 소개합니다.'
date: 2024-12-19
thumbnail: /posts/codeLab/its-me-rag-chatbot/thumbnail.avif
category: 'codeLab'
---

# AI 기반 인터랙티브 포트폴리오 챗봇 (its-me)

## 1. 개요/목적/배경

**왜 이 프로젝트를 만들었는가?**
기존 포트폴리오 웹사이트는 정적인 정보 제공에 그쳤습니다. 채용담당자나 개발자들이 궁금한 내용을 직접 찾아야 하고, 개인화된 질문에 대한 답변을 얻기 어려웠습니다. 

**해결하고자 했던 문제점:**
- 포트폴리오 정보의 수동적 탐색 방식
- 언어별 중복된 정보 관리의 복잡성
- 외부 사이트 임베딩 시 스타일 충돌 문제
- 개인화된 질문에 대한 즉각적인 답변 부족

**목표:**
RAG(Retrieval Augmented Generation) 기술을 활용하여 대화형 포트폴리오 챗봇을 개발하고, 외부 사이트에 임베딩 가능한 독립형 위젯으로 구현하는 것

---

## 2. 기술스택

### Frontend
- **React 18.2.0** + **TypeScript 5.0.0**: 타입 안정성과 컴포넌트 기반 개발
- **Next.js 14.0.0**: SSR/SSG 지원 및 API 라우팅
- **Tailwind CSS 3.3.0**: 유틸리티 퍼스트 CSS 프레임워크
- **Vite 4.4.0**: 위젯 빌드를 위한 빠른 번들링

### Backend/AI
- **LangChain.js 0.0.208**: RAG 파이프라인 구축
- **Google Gemini API**: 대화형 AI 모델
- **Supabase**: PostgreSQL 기반 벡터 데이터베이스
- **pgvector**: HNSW 인덱스를 활용한 벡터 유사도 검색

### Deployment
- **Vercel**: API 서버 배포
- **GitHub Pages**: 위젯 정적 파일 호스팅
- **Shadow DOM**: CSS 격리를 통한 위젯 독립성

---

## 3. 주요기능

### 지능형 질문-답변 시스템
- 벡터 유사도 검색을 통한 정확한 포트폴리오 정보 검색
- 자연어 질문에 대한 맥락적 답변 제공
- 답변 실패 시 자동 fallback 질문 제안

### 다국어 지원
- 일본어/한국어 자동 감지 및 응답
- URL 파라미터 기반 언어 설정 (`?lang=ja&theme=dark`)
- 언어별 맞춤형 추천 질문 시스템

### 테마 시스템
- 라이트/다크 모드 지원
- 실시간 테마 전환
- 외부 사이트 임베딩 시 완벽한 CSS 격리

### 외부 사이트 임베딩
- 단일 스크립트 태그로 간편한 임베딩
- Shadow DOM을 통한 완벽한 스타일 격리
- CORS 처리 및 보안 고려사항 해결

---

## 4. 기능구현

### 4.1 RAG 파이프라인 구축

```typescript
// 벡터 검색 및 답변 생성
const vectorStore = new SupabaseVectorStore(embeddings, {
  client: supabase,
  tableName: "itsme",
  queryName: "match_documents"
});

const searchResults = await vectorStore.similaritySearchWithScore(
  question, 
  3, 
  { score: 0.5 }
);
```

**핵심 구현 포인트:**
- `similaritySearchWithScore`로 유사도 점수 기반 필터링
- 0.5 이상의 점수만 유효한 답변으로 판단 (실제 테스트 결과)
- 태그 기반 메타데이터 활용으로 정확도 향상

### 4.2 Shadow DOM을 통한 CSS 격리

```typescript
// 위젯 초기화 시 Shadow DOM 생성
const shadowRoot = container.attachShadow({ mode: 'open' });
const styleElement = document.createElement('style');
styleElement.textContent = cssString; // Vite ?inline으로 처리된 CSS
shadowRoot.appendChild(styleElement);
```

**해결한 문제:**
- 외부 사이트의 CSS와 충돌하지 않는 완벽한 격리
- `?inline` 접미사로 Tailwind CSS를 문자열로 변환
- 테마 클래스 적용 시 외부 DOM에 영향 없음

### 4.3 Props Priority System

```typescript
// 위젯 파라미터 우선순위 시스템
const scriptElement = document.currentScript as HTMLScriptElement;
const scriptUrlParams = new URLSearchParams(scriptElement?.src.split('?')[1] || '');
const lang = (scriptUrlParams.get('lang') || 'ja') as 'ja' | 'ko';
const theme = (scriptUrlParams.get('theme') || 'light') as 'light' | 'dark';
```

**핵심 개선사항:**
- `window.location.search` 대신 스크립트 태그의 `src` 속성에서 파라미터 읽기
- 위젯별 독립적인 설정 가능
- 블로그 임베딩 시 정확한 파라미터 전달

### 4.4 추천 질문 시스템

```typescript
// 컨텍스트 기반 추천 질문 생성
const generateSuggestions = (isFirstMessage: boolean, isSearchFailed: boolean, tags: string[]) => {
  if (isFirstMessage) return suggestions.initial;
  if (isSearchFailed) return suggestions.fallback;
  return suggestions.follow_up[tags[0]] || suggestions.fallback;
};
```

**구현 특징:**
- 초기 대화, 성공 시, 실패 시 각각 다른 질문 세트
- 태그 기반 주제별 추천 질문
- `NO_ANSWER_KEYWORD`를 통한 실패 감지

---

## 5. 성과

### 정량적 지표
- **벡터 검색 임계값**: 0.5 이상 유사도 점수로 설정 (실제 테스트 결과)
- **응답 속도**: 빠른 응답 (구체적 측정값 없음)
- **다국어 지원**: 일본어/한국어 100% 정확도 (실제 구현 완료)
- **CSS 격리**: 외부 사이트 임베딩 시 0% 스타일 충돌 (Shadow DOM 구현 완료)

### 정성적 피드백
- **사용자 경험**: 직관적인 대화형 인터페이스로 포트폴리오 탐색 용이성 향상
- **개발자 경험**: 단일 스크립트 태그로 간편한 임베딩 가능
- **유지보수성**: 컴포넌트 기반 구조로 확장성 확보

---

## 6. 인사이트

### 배운 점
- **RAG 기술의 실무 적용**: 벡터 검색과 LLM의 결합으로 정확한 정보 검색 시스템 구축
- **Shadow DOM의 활용**: 외부 사이트 임베딩 시 완벽한 격리 구현
- **Props Priority System**: 컴포넌트 설계 시 우선순위 명확화의 중요성

### 아쉬운 점과 개선 방향
- **성능 최적화**: 벡터 검색 속도 개선을 위한 인덱스 튜닝 필요
- **사용자 피드백**: 실제 사용자 데이터 수집 및 개선점 도출
- **모바일 최적화**: 반응형 디자인 개선 필요

### 다음 프로젝트에 적용할 점
- **컴포넌트 설계**: 재사용성과 확장성을 고려한 아키텍처 설계
- **에러 처리**: 사용자 친화적인 에러 메시지 및 fallback 시스템
- **테스트**: 단위 테스트 및 통합 테스트 도입으로 안정성 확보