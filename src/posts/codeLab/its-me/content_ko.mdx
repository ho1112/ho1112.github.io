---
title: 'AI 기반 RAG 인터랙티브 포트폴리오 챗봇 (its-me)'
desc: 'RAG 기반의 대화형 포트폴리오 챗봇 개발 과정과 기술적 구현 방법을 소개합니다.'
date: 2025-09-07
thumbnail: /posts/codeLab/its-me/thumbnail.avif
---

# AI 기반 RAG 인터랙티브 포트폴리오 챗봇 (its-me)

## 1. 개요

**왜 이 프로젝트를 만들었는가?**
이 프로젝트는 "AI, 직접 한번 만들어보자!"라는 순수한 호기심에서 시작됐습니다. 가장 먼저 떠오른 아이템은 챗봇이었지만 단순히 API만 호출하는 것을 넘어 특정 지식을 기반으로 답변하는 RAG(Retrieval-Augmented Generation) 기술에 더 큰 매력을 느꼈습니다.

"그럼 어떤 데이터를 학습시켜야 할까?" 고민 끝에 제가 가장 잘 알고 있고 쉽게 제공할 수 있는 데이터, 바로 **저 자신**에 대한 정보를 활용해보기로 했습니다. 그렇게 저의 경력, 스킬, 프로젝트 경험을 답변해주는 RAG 챗봇 'It's Me'가 탄생했습니다.

**목표:**
RAG(Retrieval Augmented Generation) 기술을 활용하여 대화형 포트폴리오 챗봇을 개발하고 외부 사이트에 임베딩 가능한 독립형 위젯으로 구현하는 것

---

## 2. 기술스택

### Frontend
- **Next.js**
- **TypeScript**
- **Tailwind CSS**
- **shadcn/ui**
- **Vite**: 위젯 빌드

### Backend/AI
- **LangChain.js**: RAG 파이프라인 구축
- **Google Gemini API**
- **Supabase**
- **pgvector**: HNSW 인덱스를 활용한 벡터 유사도 검색

### Deployment
- **Vercel**

---

## 3. 주요기능

### 지능형 질문-답변 시스템
- 벡터 유사도 검색을 통한 정확한 포트폴리오 정보 검색
- 자연어 질문에 대한 맥락적 답변 제공
- 답변 실패 시 자동 fallback 질문 제안

### 다국어 지원
- 일본어/한국어 자동 감지 및 응답
- URL 파라미터 기반 언어, 테마 설정 (`?lang=ja&theme=dark`)
- 언어별 맞춤형 추천 질문 시스템

### 테마 시스템
- 라이트/다크 모드 지원
- 실시간 테마 전환
- 외부 사이트 임베딩 시 완벽한 CSS 격리

### 외부 사이트 임베딩
- 단일 스크립트 태그로 간편한 임베딩
Shadow DOM을 통한 완벽한 스타일 격리
위젯을 블로그에 임베딩하자 블로그의 'prose' 스타일이 위젯의 CSS를 오염시키는 문제가 발생했습니다.
이 문제를 해결하기 위해, 과거 상용 서비스의 글로벌 네비게이션을 개발하며 사용했던 Shadow DOM 격리 패턴을 적용했습니다. 당시에도 여러 서비스에 컴포넌트를 임베딩하며 스타일 충돌을 해결했던 경험 덕분에 동일한 문제를 마주한 이 프로젝트에서도 빠르고 효과적으로 해결책을 도입할 수 있었습니다.
<Callout type="info" title="관련 프로젝트 포스트">
[Web Components(+Lit)](https://mintora.me/blog/ko/workLog/webComponents/)
[글로벌 네비게이션 프로젝트 현장](https://mintora.me/profile/ko/#skyticket)
[프로필 페이지](/profile/ko/#its-me-chatbot-container/)
</Callout>

---

## 4. 기능구현
### 4.1 아키텍처 설계
<img src="/posts/codeLab/its-me/rag_archi.svg" alt="아키텍처" width="700" />

#### DB
<img src="/posts/codeLab/its-me/table_ko.svg" alt="DB" width="500" />

### 4.2 RAG 파이프라인 구축
<img src="/posts/codeLab/its-me/data_pipeline_ko.svg" alt="pipe line" width="700" />

### 4.3 벡터 검색

```typescript
// 벡터 검색 및 답변 생성
const vectorStore = new SupabaseVectorStore(embeddings, {
  client: supabase,
  tableName: "itsme",
  queryName: "match_documents"
});

// 유사도 0.5 이상만 채용
const searchResults = await vectorStore.similaritySearchWithScore(
  question,
  3,
  { score: 0.5 }
);
```

**핵심 구현 포인트:**
- `similaritySearchWithScore`로 유사도 점수 기반 필터링
- 0.5 이상의 점수만 유효한 답변으로 판단
- 태그 기반 메타데이터 활용으로 정확도 향상

### 4.4 Shadow DOM을 통한 CSS 격리

```typescript
// 위젯 초기화 시 Shadow DOM 생성
const shadowRoot = container.attachShadow({ mode: 'open' });
const styleElement = document.createElement('style');
styleElement.textContent = cssString; // Vite ?inline으로 처리된 CSS
shadowRoot.appendChild(styleElement);
```

**해결한 문제:**
- 외부 사이트의 CSS와 충돌하지 않는 완벽한 격리
- `?inline` 접미사로 Tailwind CSS를 문자열로 변환
- 테마 클래스 적용 시 외부 DOM에 영향 없음

### 4.5 추천 질문 시스템

```typescript
// 컨텍스트 기반 추천 질문 생성
const generateSuggestions = (isFirstMessage: boolean, isSearchFailed: boolean, tags: string[]) => {
  if (isFirstMessage) return suggestions.initial;
  if (isSearchFailed) return suggestions.fallback;
  return suggestions.follow_up[tags[0]] || suggestions.fallback;
};
```

**구현 특징:**
- 초기 대화, 성공 시, 실패 시 각각 다른 질문 세트
- 태그 기반 주제별 추천 질문
- `NO_ANSWER_KEYWORD`를 통한 실패 감지

---

## 5. 성과

### 정량적 지표
- **벡터 검색 임계값**: 0.5 이상 유사도 점수로 설정
- **다국어 지원**: 일본어/한국어 지원
- **CSS 격리**: 외부 사이트 임베딩 시 스타일 충돌 해결 (Shadow DOM 구현 완료)
- **최소화 상태**: 임베딩 시 기본적으로 헤더만 노출하여 사용자가 필요할 때만 확장할 수 있는 선택권을 제공
<img src="/posts/codeLab/its-me/minimize.png" alt="최소화_최대화" width="700" />

### 정성적 피드백
- **사용자 경험**: 직관적인 대화형 인터페이스로 포트폴리오 탐색 용이성 향상
- **개발자 경험**: 단일 스크립트 태그로 간편한 임베딩 가능
- **유지보수성**: 컴포넌트 기반 구조로 확장성 확보

---

## 6. 인사이트

### 배운 점
- **RAG 기술의 실무 적용**: 벡터 검색과 LLM의 결합으로 정확한 정보 검색 시스템 구축
- **Shadow DOM의 활용**: 외부 사이트 임베딩 시 완벽한 격리 구현
- **벡터 검색과 AI의 작동 원리에 대한 이해**: 처음에는 서로 다른 언어가 벡터 공간에서 어떻게 같은 의미로 묶일 수 있는지 신기했습니다. (예: 프로젝트 ≒ プロジェクト).
만들고 조사하면서 알게 된 것은 이것이 AI가 대량의 데이터를 학습한 결과라는 점입니다. AI는 수많은 문맥 속에서 두 단어가 동일한 패턴으로 사용된다는 것을 파악하고 이를 벡터 공간상의 인접한 좌표로 배치합니다.
즉, 예전에는 불가능했던 기술이 대규모 AI 학습 덕분에 가능해졌음을 체감했고 RAG 봇이 다국어 질문에 유연하게 대응할 수 있었던 것도 결국 AI가 단순히 키워드를 매칭하는 것이 아닌 맥락과 의미를 좌표로 이해하기 때문이라는 것을 알게되었습니다.

### 아쉬운 점과 개선 방향
- **성능 최적화**: 벡터 검색 속도 개선을 위한 인덱스 튜닝 필요(현재 3072차원을 재검토하거나 로직 개선)

---

### 2025년 12월 21일 추가대응
Google AI Studio의 정책 변경으로 무료 api 사용이 제한되었습니다. 기존의 2.5-pro 모델사용이 제한되었기 때문에 3.0-flash모델로 변경하였습니다.

```typescript
const model = new ChatGoogleGenerativeAI({
  model: "gemini-2.5-pro",
  apiKey: process.env.GEMINI_API_KEY!,
  maxOutputTokens: 2048,
})
```

```typescript
const model = new ChatGoogleGenerativeAI({
  model: "gemini-3-flash-preview",
  apiKey: process.env.GEMINI_API_KEY!,
  maxOutputTokens: 2048,
})
```

<Callout type="info" title="개인 프로젝트 포스트">
[cha-LINE](/blog/ko/codeLab/cha-line/) - SBI 증권 배당금 자동 수집 및 LINE 알림 봇
[Dead Internet Theory](/blog/ko/codeLab/dead-internet-theory/) - AI 페르소나 봇 댓글 자동화 시스템
[Style Sentry](/blog/ko/codeLab/style-sentry) - CSS 코드 품질을 지키는 린터 도구
</Callout>

